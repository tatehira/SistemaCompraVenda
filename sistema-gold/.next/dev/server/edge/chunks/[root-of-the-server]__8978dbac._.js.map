{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport type { NextRequest } from 'next/server'\r\nimport { jwtVerify } from 'jose'\r\n\r\nconst SECRET_KEY = new TextEncoder().encode('my-secret-key-change-this-in-prod')\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    const session = request.cookies.get('session')?.value\r\n\r\n    if (request.nextUrl.pathname.startsWith('/dashboard')) {\r\n        if (!session) {\r\n            return NextResponse.redirect(new URL('/login', request.url))\r\n        }\r\n\r\n        try {\r\n            await jwtVerify(session, SECRET_KEY, { algorithms: ['HS256'] })\r\n        } catch (error) {\r\n            // Invalid token\r\n            return NextResponse.redirect(new URL('/login', request.url))\r\n        }\r\n    }\r\n\r\n    if (request.nextUrl.pathname === '/' || request.nextUrl.pathname === '/login') {\r\n        if (session) {\r\n            try {\r\n                await jwtVerify(session, SECRET_KEY, { algorithms: ['HS256'] })\r\n                return NextResponse.redirect(new URL('/dashboard', request.url))\r\n            } catch (e) {\r\n                // if invalid, let them stay on login\r\n            }\r\n        }\r\n    }\r\n\r\n    return NextResponse.next()\r\n}\r\n\r\nexport const config = {\r\n    matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;AAErC,eAAe,WAAW,OAAoB;IACjD,MAAM,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC,YAAY;IAEhD,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe;QACnD,IAAI,CAAC,SAAS;YACV,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9D;QAEA,IAAI;YACA,MAAM,IAAA,4KAAS,EAAC,SAAS,YAAY;gBAAE,YAAY;oBAAC;iBAAQ;YAAC;QACjE,EAAE,OAAO,OAAO;YACZ,gBAAgB;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9D;IACJ;IAEA,IAAI,QAAQ,OAAO,CAAC,QAAQ,KAAK,OAAO,QAAQ,OAAO,CAAC,QAAQ,KAAK,UAAU;QAC3E,IAAI,SAAS;YACT,IAAI;gBACA,MAAM,IAAA,4KAAS,EAAC,SAAS,YAAY;oBAAE,YAAY;wBAAC;qBAAQ;gBAAC;gBAC7D,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;YAClE,EAAE,OAAO,GAAG;YACR,qCAAqC;YACzC;QACJ;IACJ;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC5B;AAEO,MAAM,SAAS;IAClB,SAAS;QAAC;KAAoD;AAClE"}}]
}