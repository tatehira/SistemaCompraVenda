<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoldManager - Gestão de Ouro</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png"
        href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=">
</head>

<body>
    <div class="container">
        <header>
            <h1>GoldManager</h1>
            <p class="subtitle">Sistema de Gestão e Controle de Estoque de Ouro</p>
        </header>

        <!-- Action Menu -->
        <div style="margin-bottom: 2rem; text-align: right;">
            <button id="btn-add-type" class="btn btn-primary" style="width: auto;">+ Novo Tipo de Ouro</button>
        </div>

        <!-- Status Cards -->
        <div class="stats-grid" id="stats-container">
            <!-- Dynamically filled -->
        </div>

        <!-- Action Forms -->
        <div class="forms-grid">
            <!-- Purchase Form -->
            <div class="card">
                <div class="section-title">Registrar Entrada (Compra)</div>
                <form id="buy-form">
                    <div class="form-group">
                        <label>Tipo de Ouro</label>
                        <select name="gold_type" required class="gold-type-select">
                            <!-- Filled by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Peso</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="number" step="0.01" name="weight" placeholder="Quantidade" required
                                style="flex: 2;">
                            <select name="unit"
                                style="flex: 1; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border-color); color: var(--text-primary);">
                                <option value="g">Gramas (g)</option>
                                <option value="kg">Quilos (kg)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Preço Pago (R$)</label>
                        <input type="number" step="0.01" name="price" placeholder="Ex: 15000.00" required>
                    </div>
                    <div class="form-group">
                        <label>Fornecedor (Opcional)</label>
                        <input type="text" name="customer" placeholder="Nome do Fornecedor">
                    </div>
                    <div class="form-group">
                        <label>Comprovante</label>
                        <input type="file" name="receipt" accept="image/*">
                    </div>
                    <button type="submit" class="btn btn-primary">Registrar Compra</button>
                </form>
            </div>

            <!-- Sale Form -->
            <div class="card">
                <div class="section-title">Registrar Saída (Venda)</div>
                <form id="sell-form">
                    <div class="form-group">
                        <label>Tipo de Ouro</label>
                        <select name="gold_type" required class="gold-type-select">
                            <!-- Filled by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cliente</label>
                        <input type="text" name="customer" placeholder="Nome do Cliente" required>
                    </div>
                    <div class="form-group">
                        <label>Peso</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="number" step="0.01" name="weight" placeholder="Quantidade" required
                                style="flex: 2;">
                            <select name="unit"
                                style="flex: 1; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border-color); color: var(--text-primary);">
                                <option value="g">Gramas (g)</option>
                                <option value="kg">Quilos (kg)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Preço de Venda (R$)</label>
                        <input type="number" step="0.01" name="price" placeholder="Ex: 3500.00" required>
                    </div>

                    <!-- Delivery Toggle -->
                    <div class="form-group" style="display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem;">
                        <input type="checkbox" id="delivery-check" style="width: auto;">
                        <label for="delivery-check" style="margin: 0; cursor: pointer;">É para entrega?</label>
                    </div>

                    <!-- Delivery Fields (Hidden) -->
                    <div id="delivery-fields"
                        style="display: none; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 1rem;">
                        <div class="form-group">
                            <label>Entregador</label>
                            <input type="text" name="delivery_courier" placeholder="Nome do Motoboy">
                        </div>
                        <div class="form-group">
                            <label>Valor da Corrida (R$)</label>
                            <input type="number" step="0.01" name="delivery_cost" placeholder="0.00">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Data</label>
                        <input type="date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label>Comprovante</label>
                        <input type="file" name="receipt" accept="image/*">
                    </div>
                    <button type="submit" class="btn btn-danger">Registrar Venda</button>
                </form>
            </div>
        </div>

        <!-- Transactions History -->
        <div class="transactions-section">
            <div class="section-title">Histórico de Transações</div>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Ouro</th>
                            <th>Cliente / Origem</th>
                            <th>Peso (g)</th>
                            <th>Valor (R$)</th>
                            <th>Entrega</th>
                            <th>Comprovante</th>
                        </tr>
                    </thead>
                    <tbody id="transactions-body">
                        <!-- Filled by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Type Modal -->
    <div id="type-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" id="close-type">&times;</span>
            <h2>Novo Tipo de Ouro</h2>
            <form id="type-form" style="margin-top: 1.5rem;">
                <div class="form-group">
                    <label>Nome do Tipo</label>
                    <input type="text" name="type_name" placeholder="Ex: Ouro 18k, Ouro 24k, Sucata" required>
                </div>
                <button type="submit" class="btn btn-primary">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Edit Transaction Modal -->
    <div id="edit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" id="close-edit">&times;</span>
            <h2>Editar Transação</h2>
            <form id="edit-form" style="margin-top: 1.5rem;">
                <input type="hidden" name="id">
                <input type="hidden" name="type"> <!-- BUY or SELL -->

                <div class="form-group">
                    <label>Data</label>
                    <input type="date" name="date" required>
                </div>

                <div class="form-group">
                    <label>Tipo de Ouro</label>
                    <select name="gold_type_id" required class="gold-type-select">
                        <!-- Filled by JS -->
                    </select>
                </div>

                <div class="form-group">
                    <label>Peso (g)</label>
                    <input type="number" step="0.01" name="weight_grams" required>
                </div>

                <div class="form-group">
                    <label>Valor (R$)</label>
                    <input type="number" step="0.01" name="price" required>
                </div>

                <div class="form-group">
                    <label>Cliente / Fornecedor</label>
                    <input type="text" name="customer_name">
                </div>

                <!-- Fields only for Sales -->
                <div id="edit-sale-fields">
                    <div class="form-group">
                        <label>Entregador</label>
                        <input type="text" name="delivery_courier">
                    </div>
                    <div class="form-group">
                        <label>Custo Entrega</label>
                        <input type="number" step="0.01" name="delivery_cost">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Atualizar</button>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script src="app.js"></script>
</body>

</html>